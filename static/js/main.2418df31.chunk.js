(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{104:function(e,t,n){},107:function(e,t,n){},113:function(e,t,n){},114:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(21),r=n.n(o),i=(n(104),n(3)),s=n(2),l=n(4),u=n(118),d=n(123),j=(n(105),n(1)),b=["children"];function O(e){var t=e.children,n=Object(l.a)(e,b);return Object(j.jsxs)(u.a,Object(s.a)(Object(s.a)({preferCanvas:!0},n),{},{children:[t,Object(j.jsx)(d.a,{url:"https://{s}.basemaps.cartocdn.com/rastertiles/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://openstreetmap.org">OpenStreetMap</a>Contributors"'})]}))}var f=c.a.memo(O);n(107);var m=function(e){var t=Object(a.useState)(e.getBounds()),n=Object(i.a)(t,2),c=n[0],o=n[1],r=Object(a.useCallback)((function(){o(e.getBounds())}),[e]);return Object(a.useEffect)((function(){return e.on("moveend",r),e.on("zoomend",r),function(){e.off("moveend",r),e.off("zoomend",r)}}),[e,r]),c},p=n(24),h=n(122),x=n(119),v=n(120);var g=function(e){var t=e.apiStateData,n=e.visDataField,a=e.determineSegmentColor;return console.log("drawing polylines",n),Object(j.jsx)(j.Fragment,{children:t.map((function(e,c){return e.segments.map((function(o,r){return Object(j.jsx)(x.a,{positions:o.shape,color:a(o[n]),children:Object(j.jsxs)(v.a,{children:[Object(j.jsx)("h3",{className:"road-name",children:e.road}),Object.keys(o).map((function(e,t){return"shape"===e?null:Object(j.jsxs)("div",{children:[Object(j.jsxs)("h4",{className:"field-name",children:[e," (g / mi)"]}),o[e]]},t)}))]})},n+"__"+(c*t.length+r))})).flat()}))})};n(121),n(23);var F={method:"GET",mode:"cors",headers:{Accept:"application/json"}};function C(e){var t=e.url,n=e.dataField,a=e.dataBBox,c=(e.zoom,e.valueToColorFn),o="".concat(t,"/api/v1/bbox?ul=").concat(a.getNorth(),",").concat(a.getWest(),"&br=").concat(a.getSouth(),",").concat(a.getEast()),r=Object(p.c)(o,F);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(p.a,{state:r,children:Object(j.jsx)(h.a,{bounds:a,fillColor:"grey",fillOpacity:.5})}),Object(j.jsx)(p.b,{state:r,children:"Error Message"}),r.isFulfilled&&r.data&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(g,{apiStateData:r.data,visDataField:n,determineSegmentColor:c}),!1]})]})}var S=function(e,t){return e.dataBBox.equals(t.dataBBox)&&e.dataField===t.dataField},y=c.a.memo(C,S);var N,k,w=function(e){var t=Object(a.useState)(e.getZoom()),n=Object(i.a)(t,2),c=n[0],o=n[1],r=Object(a.useCallback)((function(){o(e.getZoom())}),[e]);return Object(a.useEffect)((function(){return e.on("zoom",r),function(){e.off("zoom",r)}}),[e,r]),c},B=n(6);!function(e){e.CO="CO",e.CO2="CO2",e.NOx="NOx",e.PM2P5="PM2.5"}(k||(k={}));var z=(N={},Object(B.a)(N,k.CO,[0,811]),Object(B.a)(N,k.CO2,[0,8e4]),Object(B.a)(N,k.NOx,[0,37.5]),Object(B.a)(N,k.PM2P5,[0,1.38]),N);n(113);var P=function(e){var t=e.value,n=e.setValue,a=e.allValues;return Object(j.jsx)("div",{className:"field-control-menu",children:Object(j.jsx)("ul",{className:"field-control-list",children:a.map((function(e,a){var c="field-control-button "+(e===t?"field-control-button-selected":"");return Object(j.jsx)("li",{className:"field-control-list-member",children:Object(j.jsx)("button",{className:c,onClick:function(){return n(e)},children:e})},a)}))})})};n(114);var M=function(e){for(var t=e.min,n=e.max,a=e.steps,c=e.valueToColorFn,o=(n-t)/a,r=[],i=0;i<=a;++i){var s=o*i;r.push(c(s))}var l=100/(a+1);return Object(j.jsx)("div",{className:"legend-bg",children:r.map((function(e,t){return Object(j.jsx)("div",{style:{position:"absolute",left:"".concat(l*t,"%"),width:"".concat(l,"%"),background:e,top:0,bottom:"50%"},children:Object(j.jsx)("div",{style:{position:"absolute",top:"100%",left:"5px",right:"5px",textAlign:"center",background:"white",color:"black",fontSize:"12px"},children:(n=o*t,0===n?"0":n<1?n.toFixed(2):n<100?n.toFixed(1):n<1e3?n.toFixed(0):n<1e6?Math.floor(n/1e3)+"k":void 0)})},t);var n}))})},E=n(65);n(116);var T=function(e){var t=e.msg;return Object(j.jsx)("div",{className:"warning-toast ",children:t})};function D(e){var t=e.url,n=e.mapState,c=m(n),o=w(n),r=function(){var e=Object(a.useState)(k.CO2),t=Object(i.a)(e,2);return{currentField:t[0],setField:t[1],fields:[k.CO2,k.CO,k.NOx,k.PM2P5]}}(),s=r.currentField,l=r.setField,u=r.fields,d=Object(a.useState)([c]),b=Object(i.a)(d,2),O=b[0],f=b[1],p=Object(i.a)(z[s],2),h=p[0],x=p[1];Object(a.useEffect)((function(){o<13||f((function(e){return[c]}))}),[c,o]);var v=function(e){return function(e,t,n){var a=(e-t)/(n-t);return Object(E.a)(a)}(e,h,x)};return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{style:{position:"absolute",width:"500px",left:"60px",top:"10px"},children:Object(j.jsx)(P,{value:s,setValue:l,allValues:u})}),Object(j.jsx)("div",{style:{position:"absolute",width:"408px",left:"60px",top:"40px",zIndex:1e3,height:"34px"},children:Object(j.jsx)(M,{min:h,max:x,steps:10,valueToColorFn:v})}),o<13&&Object(j.jsx)(T,{msg:"Warning: Zoomed out too far to load new data."}),O.map((function(e,n){return e?Object(j.jsx)(y,{url:t,zoom:o,dataBBox:e,dataField:s,valueToColorFn:v},n):null}))]})}var V=c.a.memo(D);var A={width:"100vw",height:"100vh"},I=[45.5051,-122.675];var Z=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(f,{style:A,center:I,zoom:13,whenCreated:c,children:n&&Object(j.jsx)(V,{mapState:n,url:"https://car-dependence-backend.herokuapp.com/api/route/"})})})},_=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,124)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),o(e),r(e)}))};r.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(Z,{})}),document.getElementById("root")),_()}},[[117,1,2]]]);
//# sourceMappingURL=main.2418df31.chunk.js.map